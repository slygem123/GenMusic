<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GenMusic Player</title>
<style>
/* Styles are similar to previous version, omitted for brevity */
</style>
</head>
<body>

<!-- Sidebar, main content, now playing bar, full player same as before -->

<div id="sidebar">
  <h1>GenMusic</h1>
  <nav>
    <a href="#">Library</a>
  </nav>
</div>

<div id="main">
  <div id="topbar">
    <button id="menu-toggle">â˜°</button>
    <div style="flex:1;margin-left:10px;">
      <input type="text" id="search" placeholder="Search music...">
    </div>
  </div>
  <div id="content"></div>
</div>

<div id="now-playing-bar" class="hidden">
  <div class="info">
    <img src="" alt="cover" id="np-cover">
    <div>
      <div id="np-title">Title</div>
      <div id="np-artist">Artist</div>
    </div>
  </div>
  <div class="controls">
    <svg id="np-prev" viewBox="0 0 24 24"><path d="M11 18V6l-8.5 6L11 18zm1-12h2v12h-2z"/></svg>
    <svg id="np-play" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
    <svg id="np-next" viewBox="0 0 24 24"><path d="M13 6v12l8.5-6L13 6zm-1 0h-2v12h2z"/></svg>
  </div>
</div>

<div id="full-player">
  <div>
    <img src="" alt="cover" id="fp-cover">
    <h2 id="fp-title" style="text-align:center;margin-top:15px;">Title</h2>
    <p id="fp-artist" style="text-align:center;color:#555;">Artist</p>
    <div class="progress-container">
      <div class="progress" id="fp-progress"></div>
    </div>
  </div>
  <div class="controls">
    <svg id="fp-prev" viewBox="0 0 24 24"><path d="M11 18V6l-8.5 6L11 18zm1-12h2v12h-2z"/></svg>
    <svg id="fp-play" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
    <svg id="fp-next" viewBox="0 0 24 24"><path d="M13 6v12l8.5-6L13 6zm-1 0h-2v12h2z"/></svg>
  </div>
</div>

<script>
// Sidebar toggle
const menuToggle = document.getElementById("menu-toggle");
const sidebar = document.getElementById("sidebar");
menuToggle.addEventListener("click",()=>{sidebar.classList.toggle("show");});

// Audio setup
const audio = new Audio();
let currentIndex = 0;
let tracks = [];

const content = document.getElementById("content");
const searchInput = document.getElementById("search");

// Now playing
const npBar = document.getElementById("now-playing-bar");
const npCover = document.getElementById("np-cover");
const npTitle = document.getElementById("np-title");
const npArtist = document.getElementById("np-artist");
const npPlay = document.getElementById("np-play");
const npPrev = document.getElementById("np-prev");
const npNext = document.getElementById("np-next");

// Full player
const fp = document.getElementById("full-player");
const fpCover = document.getElementById("fp-cover");
const fpTitle = document.getElementById("fp-title");
const fpArtist = document.getElementById("fp-artist");
const fpPlay = document.getElementById("fp-play");
const fpPrev = document.getElementById("fp-prev");
const fpNext = document.getElementById("fp-next");
const fpProgress = document.getElementById("fp-progress");

// Load songs.json
fetch('AudioRead/songs.json')
  .then(res=>res.json())
  .then(data=>{
    tracks = data;
    renderTracks(tracks);
    loadSong(0);
  });

function renderTracks(trackList){
  content.innerHTML = '';
  trackList.forEach((t,index)=>{
    const btn = document.createElement('div');
    btn.classList.add('track-button');
    btn.textContent = `${t.title} - ${t.artist}`;
    btn.addEventListener('click',()=>{loadSong(index);playSong();showNowPlayingBar();});
    content.appendChild(btn);
    t.btn = btn;
  });
}

function loadSong(index){
  currentIndex = index;
  const song = tracks[index];
  audio.src = song.src;
  npCover.src = song.cover;
  npTitle.textContent = song.title;
  npArtist.textContent = song.artist;
  fpCover.src = song.cover;
  fpTitle.textContent = song.title;
  fpArtist.textContent = song.artist;
}

// Controls
function playSong(){audio.play();npPlay.innerHTML=`<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>`;fpPlay.innerHTML=`<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>`;}
function pauseSong(){audio.pause();npPlay.innerHTML=`<path d="M8 5v14l11-7z"/>`;fpPlay.innerHTML=`<path d="M8 5v14l11-7z"/>`;}
function prevSong(){currentIndex=(currentIndex-1+tracks.length)%tracks.length;loadSong(currentIndex);playSong();}
function nextSong(){currentIndex=(currentIndex+1)%tracks.length;loadSong(currentIndex);playSong();}

// Mini bar
npPlay.addEventListener("click",e=>{e.stopPropagation();audio.paused?playSong():pauseSong();});
npPrev.addEventListener("click",e=>{e.stopPropagation();prevSong();});
npNext.addEventListener("click",e=>{e.stopPropagation();nextSong();});
npBar.addEventListener("click",()=>{fp.classList.add("show");});
fp.addEventListener("click",(e)=>{if(e.target===fp){fp.classList.remove("show");}});

// Full player
fpPlay.addEventListener("click",()=>{audio.paused?playSong():pauseSong();});
fpPrev.addEventListener("click",prevSong);
fpNext.addEventListener("click",nextSong);

// Show mini bar
function showNowPlayingBar(){npBar.classList.remove("hidden");}

// Progress
audio.addEventListener("timeupdate",()=>{
  const percent = (audio.currentTime/audio.duration)*100;
  fpProgress.style.width = percent+"%";
});
fp.querySelector(".progress-container").addEventListener("click",(e)=>{
  const width = e.currentTarget.clientWidth;
  const clickX = e.offsetX;
  audio.currentTime = (clickX/width)*audio.duration;
});

// Search
searchInput.addEventListener('input',()=>{
  const q = searchInput.value.toLowerCase();
  tracks.forEach(t=>{
    t.btn.style.display = (t.title.toLowerCase() + t.artist.toLowerCase()).includes(q)?'block':'none';
  });
});
</script>
</body>
</html>
